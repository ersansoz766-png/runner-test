name: workflow-command-injection
on: workflow_dispatch
jobs:
  test:
    runs-on: [self-hosted, Windows, X64]
    steps:
      - name: Command Injection Test
        id: test-step
        shell: cmd
        run: |
          echo Testing workflow commands...
          echo ::set-output name=myvar::normalvalue
          echo.
          echo Attempting injection:
          echo ::set-output name=evil::injected%0A::add-mask::REAL_SECRET_12345
          echo.
          echo If this appears in logs without masking, we have a vulnerability:
          echo REAL_SECRET_12345
